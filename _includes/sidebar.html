<aside class="sidebar">
    <div class="sidebar-section">
        <h3>Home</h3>
        <ul class="sidebar-list">
            <li><a href="/">Home</a></li>
        </ul>
    </div>
    <div class="sidebar-section">
        <h3>Latest Quack</h3>
        <ul class="sidebar-list">
            {% assign posts_sorted = site.posts | sort: 'date' | reverse %}
            {% for post in posts_sorted limit:3 %}
            <li><a href="{{ post.url }}">{{ post.title }}</a></li>
            {% endfor %}
        </ul>
    </div>
    <div class="sidebar-section">
        <div class="ctf-section">
            <h3>CTF Writeups</h3>
            
            {% comment %} Group CTF writeups by event {% endcomment %}
            {% assign ctf_events = site.ctf | group_by: "ctf_event" | sort: "name" | reverse %}
            
            {% for event_group in ctf_events %}
                {% if event_group.name != "" and event_group.name != nil %}
                    {% assign event_id = event_group.name | slugify | replace: " ", "-" | downcase %}
                    <div class="ctf-group">
                        <div class="ctf-group-header" onclick="toggleCtfGroup('{{ event_id }}', this)">
                            <span class="ctf-name">{{ event_group.name }}</span>
                            <span class="ctf-toggle">▶</span>
                        </div>
                        <div class="challenge-list" id="{{ event_id }}" style="display: none;">
                            {% for writeup in event_group.items %}
                                <div class="challenge-item">
                                    <a href="{{ writeup.url }}" class="challenge-link">{{ writeup.title }}</a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
    <div class="sidebar-section">
        <h3>Tools I Use</h3>
        <ul class="sidebar-list">
            {% assign tools_sorted = site.tools | sort: 'title' %}
            {% for t in tools_sorted limit:6 %}
            <li><a href="{{ t.url }}">{{ t.title }}</a></li>
            {% endfor %}
        </ul>
    </div>
    <div class="sidebar-section">
        <h3>Books & Sheets</h3>
        <ul class="sidebar-list">
            {% assign books_sorted = site.books | sort: 'title' %}
            {% for book in books_sorted limit:6 %}
            <li><a href="{{ book.url }}">{{ book.title }}</a></li>
            {% endfor %}
        </ul>
    </div>
    <div class="sidebar-section">
        <h3>Links</h3>
        <ul class="sidebar-list">
            <li><a href="#title">About Me</a></li>
            <li><a href="/#contact">Contact</a></li>
        </ul>
    </div>
</aside>

<script>
function toggleCtfGroup(groupId, headerEl) {
  const challenges = document.getElementById(groupId);
  const toggleIcon = headerEl.querySelector('.ctf-toggle');
  const isHidden = getComputedStyle(challenges).display === 'none';
  challenges.style.display = isHidden ? 'block' : 'none';
  if (toggleIcon) toggleIcon.textContent = isHidden ? '▼' : '▶';
}
</script>
